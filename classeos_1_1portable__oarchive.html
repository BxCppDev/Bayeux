<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bayeux: eos::portable_oarchive Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_bayeux_66x55_transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bayeux
   &#160;<span id="projectnumber">3.0.0</span>
   </div>
   <div id="projectbrief">Core Foundation library for SuperNEMO</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceeos.html">eos</a></li><li class="navelem"><a class="el" href="classeos_1_1portable__oarchive.html">portable_oarchive</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classeos_1_1portable__oarchive-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">eos::portable_oarchive Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Portable binary output archive using little endian format.  
 <a href="classeos_1_1portable__oarchive.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="portable__oarchive_8hpp_source.html">bayeux/datatools/eos/portable_oarchive.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for eos::portable_oarchive:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classeos_1_1portable__oarchive.png" usemap="#eos::portable_5Foarchive_map" alt=""/>
  <map id="eos::portable_5Foarchive_map" name="eos::portable_5Foarchive_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a548abbe3f9adcdb95262aa517d40b983"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeos_1_1portable__oarchive.html#a548abbe3f9adcdb95262aa517d40b983">portable_oarchive</a> (std::ostream &amp;os, unsigned flags=0)</td></tr>
<tr class="memdesc:a548abbe3f9adcdb95262aa517d40b983"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor on a stream using ios::binary mode!  <a href="#a548abbe3f9adcdb95262aa517d40b983">More...</a><br /></td></tr>
<tr class="separator:a548abbe3f9adcdb95262aa517d40b983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fabecb73f39b3a958b828f314bf0727"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeos_1_1portable__oarchive.html#a2fabecb73f39b3a958b828f314bf0727">save</a> (const std::string &amp;s)</td></tr>
<tr class="memdesc:a2fabecb73f39b3a958b828f314bf0727"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save narrow strings.  <a href="#a2fabecb73f39b3a958b828f314bf0727">More...</a><br /></td></tr>
<tr class="separator:a2fabecb73f39b3a958b828f314bf0727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfeec158b56fb88c86c8b2784b600eb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeos_1_1portable__oarchive.html#acfeec158b56fb88c86c8b2784b600eb6">save</a> (const std::wstring &amp;s)</td></tr>
<tr class="memdesc:acfeec158b56fb88c86c8b2784b600eb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save wide strings.  <a href="#acfeec158b56fb88c86c8b2784b600eb6">More...</a><br /></td></tr>
<tr class="separator:acfeec158b56fb88c86c8b2784b600eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9742091dfbe8cea0d1f3aaab6f0fcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeos_1_1portable__oarchive.html#aff9742091dfbe8cea0d1f3aaab6f0fcf">save</a> (const bool &amp;b)</td></tr>
<tr class="memdesc:aff9742091dfbe8cea0d1f3aaab6f0fcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saving bool type.  <a href="#aff9742091dfbe8cea0d1f3aaab6f0fcf">More...</a><br /></td></tr>
<tr class="separator:aff9742091dfbe8cea0d1f3aaab6f0fcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6f1f41ba76cc8bd8ba2e5d25fd503e"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a6f6f1f41ba76cc8bd8ba2e5d25fd503e"><td class="memTemplItemLeft" align="right" valign="top">boost::enable_if&lt; boost::is_integral&lt; T &gt; &gt;::type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classeos_1_1portable__oarchive.html#a6f6f1f41ba76cc8bd8ba2e5d25fd503e">save</a> (const T &amp;t, dummy&lt; 2 &gt;=0)</td></tr>
<tr class="memdesc:a6f6f1f41ba76cc8bd8ba2e5d25fd503e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save integer types.  <a href="#a6f6f1f41ba76cc8bd8ba2e5d25fd503e">More...</a><br /></td></tr>
<tr class="separator:a6f6f1f41ba76cc8bd8ba2e5d25fd503e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15ed045c75c9ddb143f55873aaadc899"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a15ed045c75c9ddb143f55873aaadc899"><td class="memTemplItemLeft" align="right" valign="top">boost::enable_if&lt; boost::is_floating_point&lt; T &gt; &gt;::type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classeos_1_1portable__oarchive.html#a15ed045c75c9ddb143f55873aaadc899">save</a> (const T &amp;t, dummy&lt; 3 &gt;=0)</td></tr>
<tr class="memdesc:a15ed045c75c9ddb143f55873aaadc899"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save floating point types.  <a href="#a15ed045c75c9ddb143f55873aaadc899">More...</a><br /></td></tr>
<tr class="separator:a15ed045c75c9ddb143f55873aaadc899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dcd2289f84382bb14603529bf49b92a"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a8dcd2289f84382bb14603529bf49b92a"><td class="memTemplItemLeft" align="right" valign="top">boost::disable_if&lt; boost::is_arithmetic&lt; T &gt; &gt;::type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classeos_1_1portable__oarchive.html#a8dcd2289f84382bb14603529bf49b92a">save</a> (const T &amp;t, dummy&lt; 4 &gt;=0)</td></tr>
<tr class="separator:a8dcd2289f84382bb14603529bf49b92a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Portable binary output archive using little endian format. </p>
<p>This archive addresses integer size, endianness and floating point types so that data can be transferred across different systems. The archive consists primarily of three different save implementations for integral types, floating point types and string types. Those functions are templates and use enable_if to be correctly selected for overloading.</p>
<dl class="section note"><dt>Note</dt><dd>The class is based on the portable binary example by Robert Ramey and uses Beman Dawes endian library plus fp_utilities by Johan Rade. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a548abbe3f9adcdb95262aa517d40b983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a548abbe3f9adcdb95262aa517d40b983">&#9670;&nbsp;</a></span>portable_oarchive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eos::portable_oarchive::portable_oarchive </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flags</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor on a stream using ios::binary mode! </p>
<p>We cannot call basic_binary_oprimitive::init which stores type sizes to the archive in order to detect transfers to non-compatible platforms.</p>
<p>We could have called basic_binary_oarchive::init which would create the <a class="el" href="namespaceboost_1_1serialization.html" title="Nested namespace of the Boost/Serialization library. ">boost::serialization</a> standard archive header containing also the library version. Due to efficiency we stick with our own. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2fabecb73f39b3a958b828f314bf0727"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fabecb73f39b3a958b828f314bf0727">&#9670;&nbsp;</a></span>save() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void eos::portable_oarchive::save </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save narrow strings. </p>

</div>
</div>
<a id="acfeec158b56fb88c86c8b2784b600eb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfeec158b56fb88c86c8b2784b600eb6">&#9670;&nbsp;</a></span>save() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void eos::portable_oarchive::save </td>
          <td>(</td>
          <td class="paramtype">const std::wstring &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save wide strings. </p>
<p>This is rather tricky to get right for true portability as there are so many different character encodings around. However, wide strings that are encoded in one of the Unicode schemes only need to be <em>transcoded</em> which is a lot easier actually.</p>
<p>We expect the input string to be encoded in the system's native format, ie. UTF-16 on Windows and UTF-32 on Linux machines. Don't know about Mac here so I can't really say about that. </p>

</div>
</div>
<a id="aff9742091dfbe8cea0d1f3aaab6f0fcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff9742091dfbe8cea0d1f3aaab6f0fcf">&#9670;&nbsp;</a></span>save() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void eos::portable_oarchive::save </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Saving bool type. </p>
<p>Saving bool directly, not by const reference because of tracking_type's operator (bool).</p>
<dl class="section note"><dt>Note</dt><dd>If you cannot compile your application and it says something about save(bool) cannot convert your type const A&amp; into bool then you should check your BOOST_CLASS_IMPLEMENTATION setting for A, as portable_archive is not able to handle custom primitive types in a general manner. </dd></dl>

</div>
</div>
<a id="a6f6f1f41ba76cc8bd8ba2e5d25fd503e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f6f1f41ba76cc8bd8ba2e5d25fd503e">&#9670;&nbsp;</a></span>save() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::enable_if&lt;boost::is_integral&lt;T&gt; &gt;::type eos::portable_oarchive::save </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dummy&lt; 2 &gt;&#160;</td>
          <td class="paramname"> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save integer types. </p>
<p>First we save the size information ie. the number of bytes that hold the actual data. We subsequently transform the data using store_little_endian and store non-zero bytes to the stream. </p>

</div>
</div>
<a id="a15ed045c75c9ddb143f55873aaadc899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15ed045c75c9ddb143f55873aaadc899">&#9670;&nbsp;</a></span>save() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::enable_if&lt;boost::is_floating_point&lt;T&gt; &gt;::type eos::portable_oarchive::save </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dummy&lt; 3 &gt;&#160;</td>
          <td class="paramname"> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save floating point types. </p>
<p>We simply rely on fp_traits to extract the bit pattern into an (unsigned) integral type and store that into the stream. Francois Mauger provided standardized behaviour for special values like inf and NaN, that need to be serialized in his application.</p>
<dl class="section note"><dt>Note</dt><dd>by Johan Rade (author of the floating point utilities library): Be warned that the math::detail::fp_traits&lt;T&gt;::type::get_bits() function is <em>not</em> guaranteed to give you all bits of the floating point number. It will give you all bits if and only if there is an integer type that has the same size as the floating point you are copying from. It will not give you all bits for double if there is no uint64_t. It will not give you all bits for long double if sizeof(long double) &gt; 8 or there is no uint64_t.</dd></dl>
<p>The member fp_traits&lt;T&gt;::type::coverage will tell you whether all bits are copied. This is a typedef for either math::detail::all_bits or math::detail::not_all_bits.</p>
<p>If the function does not copy all bits, then it will copy the most significant bits. So if you serialize and deserialize the way you describe, and fp_traits&lt;T&gt;::type::coverage is math::detail::not_all_bits, then your floating point numbers will be truncated. This will introduce small rounding off errors. </p>

</div>
</div>
<a id="a8dcd2289f84382bb14603529bf49b92a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dcd2289f84382bb14603529bf49b92a">&#9670;&nbsp;</a></span>save() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::disable_if&lt;boost::is_arithmetic&lt;T&gt; &gt;::type eos::portable_oarchive::save </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dummy&lt; 4 &gt;&#160;</td>
          <td class="paramname"> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>bayeux/datatools/eos/<a class="el" href="portable__oarchive_8hpp_source.html">portable_oarchive.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
