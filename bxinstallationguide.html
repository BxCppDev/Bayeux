<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bayeux: Installing Bayeux from Source</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_bayeux_66x55_transparent.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bayeux
   &#160;<span id="projectnumber">3.0.0</span>
   </div>
   <div id="projectbrief">Core Foundation library for SuperNEMO</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Installing Bayeux from Source </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#intro">Introduction </a></li>
<li class="level1"><a href="#bxinstallationguide_preparation">Preparing Your System for Installation </a></li>
<li class="level1"><a href="#bxinstallationguide_getting">Getting Bayeux </a><ul><li class="level2"><a href="#bxinstallationguide_workspace">Setting Up a Bayeux Workspace </a></li>
<li class="level2"><a href="#bxinstallationguide_checkout">Checking out Bayeux </a></li>
</ul>
</li>
<li class="level1"><a href="#bxinstallationguide_buildinstall">Building and Installing Bayeux </a></li>
<li class="level1"><a href="#bxinstallationguide_using">Using Bayeux </a></li>
<li class="level1"><a href="#bxinstallationguide_trouble">Troubleshooting </a></li>
<li class="level1"><a href="#bxinstallationguide_developing">Developing Bayeux </a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction </h1>
<p>This walkthrough is intended to get you up and running with Bayeux as fast as possible. It therefore adopts a specific layout of where working copies of sources, builds of these sources and installs of the builds. You do not have to follow this layout, but we recommend it as a fast and convenient way to organise things. We welcome constructive comments, criticisms and suggestions for improvement, and these should be directed to the Bayeux/SuperNEMO Software Working Group.</p>
<h1><a class="anchor" id="bxinstallationguide_preparation"></a>
Preparing Your System for Installation </h1>
<p>To install the Bayeux stack, you first need the following:</p>
<ul>
<li>UNIX Operating System<ul>
<li>Linux (Ubuntu 14-16, SUSE 11/12, RedHat/CentOS/Scientific 6/7)<ul>
<li>Other distributions should work provided they supply the software requirements listed below</li>
</ul>
</li>
<li>Mac OS X 10.9/10/11 (Mavericks/Yosemite/El Capitan)<ul>
<li>Earlier versions should work, but are not tested</li>
</ul>
</li>
</ul>
</li>
<li>2-3GB of free disk space:<ul>
<li>At least 200MB for a source code check out</li>
<li>An additional 1GB for the main build</li>
</ul>
</li>
<li>Familiarity with the UNIX command line</li>
<li>Required Software<ul>
<li>Subversion 1.6 or above</li>
<li>CMake 3.3 or above</li>
<li>Doxygen 1.8 or above</li>
<li>C/C++ compiler supporting at least the C++03 standard<ul>
<li>GCC 4.5 or above, and Clang 3.1 or above are recommended</li>
<li>If available, you should use a C++11 compliant compiler<ul>
<li>GCC 4.9 or higher, Clang 3.3 or higher</li>
<li>This is purely for the best forward compatibility, it is not a requirement.</li>
</ul>
</li>
<li>On OS X systems, you should install Xcode from the App Store, and ensure the Command Line Tools are installed We recommend that the Required Software are installed via the relevant package manager (e.g. yum, apt on Linux, Homebrew or MacPorts on Mac OS X) for your system, unless the version requirement listed is not met.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>In addition to the tools used to build Bayeux, the following libraries are needed to support its functionality:</p>
<ul>
<li><a href="http://www.boost.org">Boost C++ Libraries</a> 1.55.0 and higher</li>
<li><a href="https://github.com/tegesoft/camp">CAMP C++ Reflection Library</a> 0.7.1 and higher</li>
<li><a href="http://proj-clhep.web.cern.ch/proj-clhep/">CLHEP C++ HEP Library</a> 2.1.3.1 and higher</li>
<li><a href="http://www.gnu.org/software/gsl/">GNU Scientific Library</a> 1.15 and higher</li>
<li><a href="http://root.cern.ch">ROOT C++ HEP Toolkit</a> 5.34.30 and higher</li>
<li><a href="http://geant4.cern.ch">Geant4 C++ Toolkit for Detector Simulations</a> 9.6.4 and higher</li>
<li>BZip2 Library and Headers</li>
<li>zlib Library and Headers</li>
<li>readline Library and Headers</li>
</ul>
<p>You can reuse any existing installations of these libraries on your system to build Bayeux against. For the easiest and most robust installation, we recommend using the <code>Cadfael</code> Software Development Kit. This is based on the <a href="https://github.com/linuxbrew/linuxbrew">Linuxbrew</a> cross UNIX platform package manager and provides a robust installation of the dependencies. It also provides the needed build tools listed earlier. To install <code>Cadfael</code> and the requisite software packages, see the dedicated <a href="https://github.com/SuperNEMO-DBD/brew">installtion guide</a>.</p>
<p>We expect the Bayeux stack to compile and run on most modern BSD or Linux based systems provided the listed Required Software is installed. Note however that this list is a work in progress, and sections below will highlight where problems may occur with missing software, and how to report and resolve these issues.</p>
<h1><a class="anchor" id="bxinstallationguide_getting"></a>
Getting Bayeux </h1>
<p>Bayeux is developed using the Subversion repository hosted by <a href="https://nemo.lpc-caen.in2p3.fr">LPC Caen</a>. Whilst you need a full account to commit to the repository, we will be using the provided read-only access.</p>
<p>To work with the software, we recommend using the following layout of code in directories:</p>
<div class="fragment"><div class="line">BxSoftware/</div><div class="line">|-- lpc-caen.svn</div><div class="line">|-- builds</div><div class="line">|-- installs</div></div><!-- fragment --><p>where the <code>BxSoftware</code> is the arbitrary name of a directory that can be located where you wish, though it must be on a filesystem with the required free space.</p>
<h2><a class="anchor" id="bxinstallationguide_workspace"></a>
Setting Up a Bayeux Workspace </h2>
<p>If you already have a workspace setup, then you can skip to the <a class="el" href="bxinstallationguide.html#bxinstallationguide_checkout">following section</a>. Otherwise to create it, open a terminal, and choose a directory for your software workspace. For clarity in this guide, because absolute paths are needed in certain cases, we will use the dummy directory <code>/Users/ben</code>, but you should choose your own location (<code>${HOME}/Software</code>, <code>/usr/local</code>...). The first step is to create the directory hierarchy:</p>
<div class="fragment"><div class="line">$ cd /Users/ben</div><div class="line">$ mkdir -p BxSoftware/{lpc-caen.svn,builds,installs}</div><div class="line">$ cd BxSoftware</div><div class="line">$ ls</div><div class="line">builds  installs  lpc-caen.svn</div></div><!-- fragment --><p>With the directories in place, we can checkout the code. This is done via the <code>svn</code> command line client, and we be using a "sparse checkout" pattern. Whilst this requires a few more steps upfront, it provides a very stable and well organised working copy.</p>
<p>Note that in the following, we demonstrate how create a checkout by the fastest and easiest means possible. This means that you end up with:</p>
<ul>
<li>A read-only repository<ul>
<li>You can update, view logs and create diffs and patches</li>
<li>You cannot commit changes</li>
</ul>
</li>
</ul>
<p>If you already have a developer's account at LPC Caen, then the following instructions will also work, simply remove the <code>--username</code> and <code>--no-auth-cache</code> arguments from the svn commands.</p>
<div class="fragment"><div class="line">$ pwd</div><div class="line">/path/to/your/chosen/workspace/BxSoftware</div><div class="line">$ svn co https://nemo.lpc-caen.in2p3.fr/svn --username=visitor --no-auth-cache \</div><div class="line">--depth empty lpc-caen.svn</div></div><!-- fragment --><p>At this point, you may see a warning about certificates:</p>
<div class="fragment"><div class="line">Error validating server certificate for &#39;https://nemo.lpc-caen.in2p3.fr:443&#39;:</div><div class="line"> - The certificate is not issued by a trusted authority. Use the</div><div class="line">   fingerprint to validate the certificate manually!</div><div class="line"> - The certificate hostname does not match.</div><div class="line"> - The certificate has expired.</div><div class="line">Certificate information:</div><div class="line"> - Hostname: caedev.in2p3.fr</div><div class="line"> - Valid: from Thu, 15 May 2008 11:52:02 GMT until Fri, 15 May 2009 11:52:02 GMT</div><div class="line"> - Issuer: LPC Caen, CNRS, Caen, France, Fr</div><div class="line"> - Fingerprint: ae:89:9e:38:e3:80:a7:a3:b2:1e:df:5e:eb:33:2d:ba:83:be:b7:11</div><div class="line">(R)eject, accept (t)emporarily or accept (p)ermanently? p</div></div><!-- fragment --><p>Simply press <code>t</code> or <code>p</code> to accept the certificate. The process will then continue by asking for the password for <code>visitor</code>, for which you should enter <code>anonymous</code> (If you have accessed the LPC repository before, you may not see either the certificate check or password prompt).</p>
<div class="fragment"><div class="line">Password for &#39;visitor&#39;:</div><div class="line">Checked out revision 15106.</div></div><!-- fragment --><p>The revision number you see will vary depending on the current state of development. If you now list the contents of the <code>lpc-caen.svn</code> directory it will be empty apart from a <code>.svn</code> directory. We now checkout the parts we need, specifically the <code>Bayeux</code> project.</p>
<div class="fragment"><div class="line">$ pwd</div><div class="line">/Users/ben/BxSoftware</div><div class="line">$ cd lpc-caen.svn</div><div class="line">$ svn up --set-depth immediates Bayeux</div><div class="line">A    Bayeux</div><div class="line">A    Bayeux/trunk</div><div class="line">A    Bayeux/branches</div><div class="line">A    Bayeux/tags</div><div class="line">Updated to revision 15106.</div></div><!-- fragment --><p>As above, the revision number will depend on the current state of development. Each LPC project is organised using the standard Subversion directory layout of <code>trunk</code> for the mainline of development, <code>branches</code> for feature implementation and bug fixes, and <code>tags</code> for releases.</p>
<p>An <code>ls</code> of the above directories will show that, again, they are empty. However, if you use Subversion's list command, e.g.</p>
<div class="fragment"><div class="line">$ svn ls Bayeux/trunk</div><div class="line">CMakeLists.txt</div><div class="line">...</div></div><!-- fragment --><p>you will get a listing of the contents in the upstream repository. This is what we mean by a "sparse checkout". Such a working copy allows you to query the repository for what is available, and then choose the parts you want to checkout. For example, you can get a list of the current tags of Bayeux by doing</p>
<div class="fragment"><div class="line">$ svn ls Bayeux/tags</div><div class="line">Bayeux-2.0.0/</div><div class="line">Bayeux-2.0.1/</div><div class="line">...</div><div class="line">Bayeux-3.0.0/</div></div><!-- fragment --><p>Tags are always named using the standard <code>MAJOR.MINOR.PATCH</code> convention with an optional additional <code>-STATUSN</code> flag to indicate development lines.</p>
<h2><a class="anchor" id="bxinstallationguide_checkout"></a>
Checking out Bayeux </h2>
<p>With the workspace in place, we can checkout the required development lines of Bayeux. The version of Bayeux to which this documentation refers is 3.0.0. To check this tags out from scratch we do</p>
<div class="fragment"><div class="line">$ svn ls Bayeux/tags</div><div class="line">...</div><div class="line">$ svn up --set-depth infinity Bayeux/tags/Bayeux-3.0.0</div></div><!-- fragment --><p>The basic source code working copy is now in place. For more details on using Subversion, we recommend the <a href="http://svnbook.red-bean.com/">Subversion Red Bean Guide</a>.</p>
<h1><a class="anchor" id="bxinstallationguide_buildinstall"></a>
Building and Installing Bayeux </h1>
<p>Bayeux uses the <a href="http://www.cmake.org">CMake</a> tool for driving the configure, build and install of its core library and applications. To ensure we don't mix up core source files with those generated by the build, we create a separate directory in which to configure and build under <code>builds</code> first:</p>
<div class="fragment"><div class="line">$ cd /Users/ben/BxSoftware</div><div class="line">$ ls</div><div class="line">builds  installs  lpc-caen.svn</div><div class="line">$ cd builds</div><div class="line">$ mkdir bayeux-3.0.0</div><div class="line">$ cd bayeux-3.0.0</div></div><!-- fragment --><p>The naming of the build directory is arbitrary, but it's useful to give them a name related to the build task.</p>
<p>We now run cmake in the build directory to configure the build. Here, we've used the <a href="https://cmake.org/cmake/help/v3.3/variable/CMAKE_INSTALL_PREFIX.html"><code>CMAKE_INSTALL_PREFIX</code></a> variable to specify where to install the build products.</p>
<div class="fragment"><div class="line">$ cmake -DCMAKE_INSTALL_PREFIX=/Users/ben/BxSoftware/installs/bayeux-3.0.0 \</div><div class="line"> ../../lpc-caen.svn/Bayeux/tags/Bayeux-3.0.0</div><div class="line">...</div><div class="line">-- Configuring done</div><div class="line">-- Generating done</div><div class="line">-- Build files have been written to: /Users/ben/BxSoftware/builds/bayeux-3.0.0</div></div><!-- fragment --><p>Further options may be passed to CMake either via <code>-D&lt;OPTION&gt;={ON|OFF}</code> arguments on the command line or through the CMake curses/GUI interfaces to configure optional parts of Bayeux:</p>
<ul>
<li><code>BAYEUX_ENABLE_TESTING</code> : build the collection of testing programs (default: OFF),</li>
<li><code>BAYEUX_WITH_DOCS</code> : build and install the documentation (build with Doxygen, default: ON)</li>
<li><code>BAYEUX_WITH_DOCS_OCD</code> : build and install <a class="el" href="bxocd.html">Object Configuration Description</a> (OCD) documentation (default: ON, only if <code>Bayeux_BUILD_DOCS</code> is set).</li>
<li><code>BAYEUX_WITH_GEANT4_MODULE</code> : build the Bayeux/mctools Geant4 plugin library and associated tools (default: ON),</li>
<li><code>BAYEUX_WITH_DEVELOPER_TOOLS</code> : build and install utilities for developers (helper scripts and tools, default: ON)</li>
</ul>
<p>The exact output of the configuration step will depend on the OS you are running on, the compiler detected and the exact CMake version (later versions are more verbose). The important thing to check is that you see the last three lines</p>
<div class="fragment"><div class="line">-- Configuring done</div><div class="line">-- Generating done</div><div class="line">-- Build files have been written to: /Users/ben/BxSoftware/builds/bayeux-3.0.0</div></div><!-- fragment --><p>which indicate a successful configuration. By default, CMake generates a Makefile describing the build of Bayeux, so to run the build we just run <code>make</code>:</p>
<div class="fragment"><div class="line">$ make -j4</div><div class="line">Scanning dependencies of target ...</div><div class="line">...</div><div class="line">[  0%] Building CXX object ...</div><div class="line">...</div></div><!-- fragment --><p>You should select the integer passed to <code>-j</code> based on the number of cores your system has, e.g. 4 for a quad core system. With parallel builds the exact output will vary, but a successful build will generally be indicated by the last lines being:</p>
<div class="fragment"><div class="line">...</div><div class="line">[100%] Built target ...</div></div><!-- fragment --><p>After a successful build, you can install Bayeux to the location you passed to <code>CMAKE_INSTALL_PREFIX</code> with</p>
<div class="fragment"><div class="line">$ make install</div></div><!-- fragment --><p>This will install everything required into a POSIX style hierarchy under the install prefix:</p>
<div class="fragment"><div class="line">installs/bayeux-3.0.0</div><div class="line">|-- bin</div><div class="line">|-- include</div><div class="line">|   `-- bayeux</div><div class="line">|-- lib{64/arch}</div><div class="line">|   |-- cmake</div><div class="line">|   `-- Bayeux</div><div class="line">`-- share</div><div class="line">    `-- Bayeux-3.0.0</div></div><!-- fragment --><p>Note that the exact name of the <code>lib</code> directory will depend on the specifics of your platform.</p>
<p>If the <code>Bayeux_ENABLE_TESTING</code> configure option has been set, you can run unit tests for Bayeux by "building" the <code>test</code> target:</p>
<div class="fragment"><div class="line">$ make test</div><div class="line">Running tests...</div><div class="line">Test project /data2/sw/BxSoftware/builds/bayeux-3.0.0</div><div class="line">        Start   1: datatools-test_enriched_base</div><div class="line">  1/243 Test   #1: datatools-test_enriched_base ..................   Passed    0.05 sec</div><div class="line">...</div></div><!-- fragment --><p>This will run all available testing programs and will report their success or failure. If all tests are successful, it will print these last lines:</p>
<div class="fragment"><div class="line">...</div><div class="line">        Start 243: bayeux-test_bayeux</div><div class="line">243/243 Test #243: bayeux-test_bayeux ............................   Passed    0.06 sec</div><div class="line"></div><div class="line">100% tests passed, 0 tests failed out of 243</div><div class="line"></div><div class="line">Total Test time (real) =  28.92 sec</div></div><!-- fragment --><p>which indicates that no errors occured.</p>
<p>You do not require any environment setup to use the installed applications, though you may, at your preference, prepend the ̀installs/bayeux-3.0.0/bin<code> path to your UNIX</code>PATH`. From a sh shell, this may write:</p>
<div class="fragment"><div class="line">export PATH=/Users/ben/BxSoftware/installs/bayeux-3.0.0/bin:${PATH}</div></div><!-- fragment --><p>Once you have installed Cadfael successfully, you can safely remove the build directory to save disk space.</p>
<h1><a class="anchor" id="bxinstallationguide_using"></a>
Using Bayeux </h1>
<p>TODO</p>
<h1><a class="anchor" id="bxinstallationguide_trouble"></a>
Troubleshooting </h1>
<p>Whilst this walkthrough guide should cover most uses cases, we cannot guarantee that problems will not be encountered. If you do experience issues with any of the steps, please contact us, in the first instance email your issue to:</p>
<ul>
<li>Xavier Garrido (<a href="#" onclick="location.href='mai'+'lto:'+'gar'+'ri'+'do@'+'la'+'l.i'+'n2'+'p3.'+'fr'; return false;">garri<span style="display: none;">.nosp@m.</span>do@l<span style="display: none;">.nosp@m.</span>al.in<span style="display: none;">.nosp@m.</span>2p3.<span style="display: none;">.nosp@m.</span>fr</a>)</li>
<li>François Mauger (<a href="#" onclick="location.href='mai'+'lto:'+'mau'+'ge'+'r@l'+'pc'+'cae'+'n.'+'in2'+'p3'+'.fr'; return false;">mauge<span style="display: none;">.nosp@m.</span>r@lp<span style="display: none;">.nosp@m.</span>ccaen<span style="display: none;">.nosp@m.</span>.in2<span style="display: none;">.nosp@m.</span>p3.fr</a>)</li>
<li>Ben Morgan (<a href="#" onclick="location.href='mai'+'lto:'+'Ben'+'.M'+'org'+'an'+'@wa'+'rw'+'ick'+'.a'+'c.u'+'k'; return false;">Ben.M<span style="display: none;">.nosp@m.</span>orga<span style="display: none;">.nosp@m.</span>n@war<span style="display: none;">.nosp@m.</span>wick<span style="display: none;">.nosp@m.</span>.ac.u<span style="display: none;">.nosp@m.</span>k</a>)</li>
</ul>
<p>TODO Setup :</p><ul>
<li>bayeux-developers-l@[lpccaen.]in2p3.fr mailing list</li>
<li>bayeux-users-l@[lpccaen.}in2p3.fr mailing list</li>
</ul>
<p>Please attach as much information as possible (operating system and version, compiler and version, CMake version etc) to assist in diagnosing the issue.</p>
<h1><a class="anchor" id="bxinstallationguide_developing"></a>
Developing Bayeux </h1>
<p>To checkout the trunk of Bayeux, we use the same procedure as for checking out a release and just change the path slightly:</p>
<div class="fragment"><div class="line">$ cd /Users/ben/BxSoftware</div><div class="line">$ ls</div><div class="line">builds  installs  lpc-caen.svn</div><div class="line">$ cd lpc-caen.svn</div><div class="line">$ svn up --set-depth infinity Bayeux/trunk</div><div class="line">...</div><div class="line">$ ls Bayeux/trunk</div><div class="line">cmake       CMakeLists.txt  devel  examples     README.rst</div><div class="line">CMakeFiles  COPYING.txt     doc    LICENSE.txt  source</div><div class="line">$</div></div><!-- fragment --><p>This trunk version can be configured, built and tested using CMake just as described in <a class="el" href="bxinstallationguide.html#bxinstallationguide_buildinstall">the installation guide above</a>. It is not recommended to install trunk builds due to the ongoing development cycle.</p>
<p>Other than the unit tests, Bayeux's builtin programs can be run directly from the build directory. All products of the build are output into a <code>BuildProducts</code> subdirectory of the main build directory. <code>BuildProducts</code> contains a directory hierarchy matching that of the final install prefix, by default:</p>
<div class="fragment"><div class="line">builddir/BuildProducts</div><div class="line">|-- bin</div><div class="line">|-- include</div><div class="line">|   `-- bayeux</div><div class="line">|-- lib{64/arch}</div><div class="line">|   |-- cmake</div><div class="line">|   `-- Bayeux</div><div class="line">`-- share</div><div class="line">    `-- Bayeux-3.0.0</div></div><!-- fragment --><p>Programs under the <code>bin</code> subdirectory may be run directly as required for testing or using. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
